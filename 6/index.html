<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canvas Image Lab</title>
    <style>
        * { box-sizing: border-box; }
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: #f4f4f6;
            color: #1f1f1f;
        }
        .app {
            max-width: 1200px;
            margin: 0 auto;
            padding: 16px;
        }
        h1 { margin: 0 0 12px; }
        h3 { margin: 8px 0; }
        .controls {
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 12px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 16px;
        }
        .row {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
        }
        label { font-weight: bold; }
        select, input, button {
            padding: 6px 8px;
            border-radius: 4px;
            border: 1px solid #ccc;
            font-size: 14px;
        }
        button {
            cursor: pointer;
            background: #1f6feb;
            color: #fff;
            border: none;
        }
        button.secondary { background: #6c757d; }
        .canvas-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 12px;
        }
        .card {
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 10px;
        }
        canvas {
            width: 100%;
            height: auto;
            border: 1px solid #ddd;
            background: #fafafa;
        }
        .kernel-grid {
            display: grid;
            grid-template-columns: repeat(3, 70px);
            gap: 4px;
        }
        .kernel-grid input {
            width: 70px;
            text-align: center;
        }
        .pipeline {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }
        .chip {
            background: #e8f0fe;
            border: 1px solid #c5d7ff;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .chip-actions {
            display: flex;
            gap: 4px;
        }
        .chip-btn {
            border: none;
            background: #1f6feb;
            color: #fff;
            border-radius: 8px;
            width: 22px;
            height: 22px;
            padding: 0;
            line-height: 22px;
            text-align: center;
            font-size: 12px;
            cursor: pointer;
        }
        .chip-btn.secondary {
            background: #6c757d;
        }
        .hist-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 8px;
        }
        .note { font-size: 12px; color: #555; }
    </style>
    <script src="scripts/script.js" type="text/javascript" defer></script>
</head>
<body>
    <div class="app">
        <h1>Canvas Image Lab</h1>
        <div class="controls">
            <div class="row">
                <label for="fileInput">Image:</label>
                <input type="file" id="fileInput" accept="image/*">
                <button id="downloadBtn">Download processed</button>
                <span class="note">Default image loads automatically.</span>
            </div>
            <div class="row">
                <label for="filterSelect">Filter:</label>
                <select id="filterSelect">
                    <option value="edge">Edge detect (Laplacian)</option>
                    <option value="gaussian">Gaussian blur</option>
                    <option value="sharpen">Sharpen</option>
                    <option value="emboss">Emboss</option>
                    <option value="diagonalEmboss">Diagonal emboss</option>
                    <option value="boxBlur">Box blur</option>
                    <option value="threshold">Threshold / binarize</option>
                    <option value="invert">Negative / invert</option>
                    <option value="sepia">Sepia tone</option>
                    <option value="posterize">Posterize</option>
                    <option value="custom">Custom kernel (3x3)</option>
                </select>
                <button id="applyBtn">Apply</button>
                <button id="addPipelineBtn">Add to pipeline</button>
                <button id="runPipelineBtn">Run pipeline</button>
                <button id="clearPipelineBtn" class="secondary">Clear pipeline</button>
            </div>
            <div class="row">
                <label for="intensitySlider">Blend amount:</label>
                <input type="range" id="intensitySlider" min="0" max="100" value="100">
                <span id="intensityValue">100%</span>
                <label for="paramSlider">Filter parameter:</label>
                <input type="range" id="paramSlider" min="0" max="255" value="128">
                <span id="paramValue">128</span>
                <span class="note">Used for threshold level or posterize steps.</span>
            </div>
            <div class="row">
                <label for="compareSlider">Comparison split:</label>
                <input type="range" id="compareSlider" min="0" max="100" value="50">
                <span id="compareValue">50%</span>
                <span class="note">Left processed / right original.</span>
            </div>
            <div class="row">
                <div>
                    <div class="note">Custom 3Ã—3 kernel</div>
                    <div class="kernel-grid" id="kernelGrid"></div>
                </div>
            </div>
            <div class="row">
                <strong>Pipeline:</strong>
                <div class="pipeline" id="pipelineList"></div>
            </div>
        </div>

        <div class="canvas-row">
            <div class="card">
                <h3>Original</h3>
                <canvas id="originalCanvas"></canvas>
            </div>
            <div class="card">
                <h3>Processed (with blend)</h3>
                <canvas id="targetCanvas"></canvas>
            </div>
            <div class="card">
                <h3>Comparison</h3>
                <canvas id="compareCanvas"></canvas>
            </div>
        </div>
        <div class="card" style="margin-top:12px;">
            <h3>Histograms</h3>
            <div class="hist-container">
                <div>
                    <div class="note">Original</div>
                    <canvas id="histOriginal" width="256" height="80"></canvas>
                </div>
                <div>
                    <div class="note">Processed</div>
                    <canvas id="histProcessed" width="256" height="80"></canvas>
                </div>
            </div>
        </div>
    </div>
</body>
</html>